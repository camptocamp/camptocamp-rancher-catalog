---
version: '2'
services:
  bivac:
    image: ${BIVAC_IMAGE_REPOSITORY}:${BIVAC_IMAGE_TAG}
    environment:
      BIVAC_FULL_IF_OLDER_THAN: ${BIVAC_FULL_IF_OLDER_THAN}
      BIVAC_REMOVE_OLDER_THAN: ${BIVAC_REMOVE_OLDER_THAN}
      BIVAC_VOLUMES_BLACKLIST: ${BIVAC_VOLUMES_BLACKLIST}
      BIVAC_VOLUMES_WHITELIST: ${BIVAC_VOLUMES_WHITELIST}
      BIVAC_NO_VERIFY: ${BIVAC_NO_VERIFY}
      BIVAC_LOG_LEVEL: ${BIVAC_LOG_LEVEL}
      BIVAC_JSON_OUTPUT: ${JSON_OUTPUT}
      BIVAC_TARGET_URL: ${BIVAC_TARGET_URL}
      BIVAC_ENGINE: ${BIVAC_ENGINE}
      RESTIC_PASSWORD: ${RESTIC_PASSWORD}
      PUSHGATEWAY_URL: ${PUSHGATEWAY_URL}
      AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID}
      AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY}
      OS_AUTH_URL: ${OS_AUTH_URL}
      OS_TENANT_NAME: ${OS_TENANT_NAME}
      OS_USERNAME: ${OS_USERNAME}
      OS_PASSWORD: ${OS_PASSWORD}
      OS_REGION_NAME: ${OS_REGION_NAME}
      OS_USER_DOMAIN_NAME: ${OS_USER_DOMAIN_NAME}
      OS_PROJECT_NAME: ${OS_PROJECT_NAME}
      OS_PROJECT_DOMAIN_NAME: ${OS_PROJECT_DOMAIN_NAME}
    labels:
      cron.schedule: 0 ${BIVAC_RUN_TIME}
      io.rancher.container.start_once: 'true'
      io.rancher.container.agent.role: environmentAdmin
      io.rancher.container.create_agent: 'true'
      io.upkick.warn_only: 'false'
